#!/bin/bash -l

#SBATCH --job-name=feature_counts
#SBATCH -A beagle
#SBATCH -t 160:00:00
#SBATCH -n 64
#SBATCH --output="feature_counts.out"
#SBATCH --error="feature_counts.err"

module purge
module load biocontainers
#module load subread/2.0.1
module load subread/1.6.4

cd /scratch/bell/nbackens/daphnia_RNAseq/02_degs/assembled_transcripts


# -p = is paired-end; -B = require that fragments have both ends successfully aligned; -C
# = chimeric fragments (ends mapped to 2 different chroms) not counted

featureCounts -p -B -C -T 64 -t exon -g gene_id -a new.gtf -o featureCount_counts.txt /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s001.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s002.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s003.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s004.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s005.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s006.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s007.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s008.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s009.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s010.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s011.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s012.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s013.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s014.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s015.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s016.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s017.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s018.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s019.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s020.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s021.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s022.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s023.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s024.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s025.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s026.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s027.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s028.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s029.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s030.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s031.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s032.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s033.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s034.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s035.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s036.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s037.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s038.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s039.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s040.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s041.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s042.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s043.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s044.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s045.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s046.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s047.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s048.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s049.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s050.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s051.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s052.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s053.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s054.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s055.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s056.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s057.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s058.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s059.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s060.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s061.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s062.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s063.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s064.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s065.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s066.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s067.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s068.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s069.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s070.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s071.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s072.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s073.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s074.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s075.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s076.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s077.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s078.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s079.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s080.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s081.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s082.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s083.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s084.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s085.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s086.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s087.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s088.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s089.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s090.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s091.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s092.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s093.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s094.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s095.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s096.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s097.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s098.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s099.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s100.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s101.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s102.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s103.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s104.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s105.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s106.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s107.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s108.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s109.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s110.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s111.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s112.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s113.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s114.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s115.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s116.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s117.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s118.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s119.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s120.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s121.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s122.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s123.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s124.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s125.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s126.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s127.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s128.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s129.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s130.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s131.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s132.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s133.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s134.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s135.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s136.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s137.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s138.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s139.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s140.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s141.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s142.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s143.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s144.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s145.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s146.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s147.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s148.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s149.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s150.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s151.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s152.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s153.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s154.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s155.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s156.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s157.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s158.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s159.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s160.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s161.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s162.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s163.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s164.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s165.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s166.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s167.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s168.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s169.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s170.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s171.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s172.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s173.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s174.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s175.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s176.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s177.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s178.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s179.sorted.bam /scratch/bell/nbackens/daphnia_RNAseq/02_degs/alignment/s180.sorted.bam
